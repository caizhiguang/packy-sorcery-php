<html>
	<head>
		<meta http-equiv="content-Type" content="text/html; charset=utf-8">
		<meta http-equiv="content-Language" content="ja">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.0/jquery.min.js"></script>
		<script src="./js/jquery.easing.1.3.js"></script>
		<script src="./js/jquery.colorsConverter.js"></script>
		<title>日系颜色表</title>
		<link rel="stylesheet" href="./css/_libraries.css">
		<link rel="stylesheet" href="./css/color.css">
	</head>
	<body>
		
		<ul id="sidebar"></ul>

		<h1></h1>
		<p></p>

		<p class="rgb">
			<span class="r">
				<span class="spinner pie"></span>
				<span class="filler pie"></span>
				<span class="mask"></span>
				<span class="name">R</span>
			</span>
			
			<span class="g">
				<span class="spinner pie"></span>
				<span class="filler pie"></span>
				<span class="mask"></span>
				<span class="name">G</span>
			</span>
			<span class="b">
				<span class="spinner pie"></span>
				<span class="filler pie"></span>
				<span class="mask"></span>
				<span class="name">B</span>
			</span>
		</p>

		<footer>
			<script src="http://s21.cnzz.com/stat.php?id=3477190&web_id=3477190" language="JavaScript"></script>
			<span> | </span>
			<a class="copyright" rel="copy" href="http://blog.lpreterite.com" >@悠闲的下午茶时间</a>
		</footer>

	<script type="text/javascript">

	jQuery(document).ready(function($){

		window.index=0;
		window.colors_scrollable = function(name,value,index){
			var data = $(document).data('colors');

			var name = name==undefined?data[window.index].name:name;
			var value = value==undefined?data[window.index].value:value;
			window.index = index==undefined?window.index:index;

			$('h1').text(name).next().text(value);
			$(document.body).css('background-color',value).animate({scrollTop:$('#sidebar>li').eq(window.index).position().top});
			window.location.hash="#"+value;

			var rgbColor = $.HextoRGB(value);
			var hsvColor = $.RGBtoHSV(rgbColor.r,rgbColor.g,rgbColor.b);
			var rgbPreColor = {
				r:rgbColor.r/255*360,
				g:rgbColor.g/255*360,
				b:rgbColor.b/255*360
			};
			var color = '#fffffc';
			if(hsvColor.v>0.89 && hsvColor.s<0.10 && hsvColor.h>30 && hsvColor.h<90)
				color = '#2e2e2e';
			else if(hsvColor.v>0.89 && hsvColor.s<0.10)
				color = '#2e2e2e';
			else if(hsvColor.v>0.89 && hsvColor.h>30 && hsvColor.h<90)
				color = '#2e2e2e';
			else if(hsvColor.v>0.80 && hsvColor.s<0.032)
				color = '#2e2e2e';
			$('h1,h1~p').css('color',color);
			$('.pie').css('border-color',color);
			$('.mask').css('background-color',value);
			// $('.r .spinner').css('transform','rotate('+rgbPreColor.r+'deg)');
			// $('.g .spinner').css('transform','rotate('+rgbPreColor.g+'deg)');
			// $('.b .spinner').css('transform','rotate('+rgbPreColor.b+'deg)');
			if(rgbPreColor.r>180)
				$('.r .mask').css('opacity',0).parents('.r').find('.spinner').css('transform','rotate('+(rgbPreColor.r-360)+'deg)').parents('.r').find('.filler').css('opacity',1);
			else
				$('.r .spinner').css('transform','rotate('+rgbPreColor.r+'deg)').parents('.r').find('.filler').css('opacity',0);

			if(rgbPreColor.r>180)
				$('.g .mask').css('opacity',0).parents('.g').find('.spinner').css('transform','rotate('+(rgbPreColor.g-360)+'deg)').parents('.g').find('.filler').css('opacity',1);
			else
				$('.g .spinner').css('transform','rotate('+rgbPreColor.g+'deg)').parents('.g').find('.filler').css('opacity',0);

			if(rgbPreColor.r>180)
				$('.b .mask').css('opacity',0).parents('.b').find('.spinner').css('transform','rotate('+(rgbPreColor.b-360)+'deg)').parents('.b').find('.filler').css('opacity',1);
			else
				$('.b .spinner').css('transform','rotate('+rgbPreColor.b+'deg)').parents('.b').find('.filler').css('opacity',0);

			window.index++
			if(window.index>=data.length)
				window.index=0;
		};

		$.ajax({
			url:'colors.xml',
			dataType:'xml',
			success:function(data,status){
				var data = data;
				for (var i = 0; i < data.length; i++) {
					$('<li></li>').css('background-color',data[i].value).attr({
						'data-name':data[i].name,
						'data-value':data[i].value,
						'data-index':i
					}).appendTo('#sidebar').click(function(){
						window.colors_scrollable($(this).attr('data-name'),$(this).attr('data-value'),$(this).attr('data-index'));
					});
				};

				$(document).data('colors',data);
				colors_scrollable();
				setInterval(window.colors_scrollable,10000);
			},
			dataFilter:function(data,type){
				var result = [];
				$(data).find('colors').children().each(function(i){
					var color = {
						name:$(this).attr('name'),
						value:$(this).attr('value')
					};
					result.push(color);
				});
				return result;
			}
		});

	});

	</script>

	</body>

</html>