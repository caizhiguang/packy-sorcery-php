<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>测试页</title>
{load:__PUBLIC__/css/libraries.css}
{load:__PUBLIC__/css/grids.css}
{load:__PUBLIC__/css/content.css}
{load:__PUBLIC__/css/mod.css}
{load:__PUBLIC__/css/form-test/mod_form.css}
{load:__PUBLIC__/css/form-test/index.css}
{load:__PUBLIC__/js/plug-in/jquery.tools.min.js}
{load:__PUBLIC__/js/plug-in/jquery.md5.js}
{load:__PUBLIC__/js/plug-in/jquery.xml2json.pack.js}
{load:__PUBLIC__/js/plug-in/drag.js}
{load:__PUBLIC__/js/plug-in/dragdrop.js}
{load:__PUBLIC__/js/salvia_debug/lib/extend.js}
{load:__PUBLIC__/js/salvia_debug/lib/salvia.js}
{load:__PUBLIC__/js/salvia_debug/class/util/events.js}
{load:__PUBLIC__/js/salvia_debug/class/util/formManager.js}
{load:__PUBLIC__/js/salvia_debug/class/base.js}
{load:__PUBLIC__/js/salvia_debug/class/base.list.js}
{load:__PUBLIC__/js/salvia_debug/class/mvc/mode.js}
{load:__PUBLIC__/js/salvia_debug/class/ui/base.js}
{load:__PUBLIC__/js/salvia_debug/class/ui/form.js}
{load:__PUBLIC__/js/salvia_debug/class/ui/msgbox.js}
{load:__PUBLIC__/js/salvia_debug/class/ui/taskbar.js}
{load:__PUBLIC__/js/salvia_debug/class/ui/list.js}
{load:__PUBLIC__/js/salvia_debug/class/ui/list.item.js}
{load:__PUBLIC__/js/salvia_debug/config.js}
{load:__PUBLIC__/js/salvia_debug/init.js}

<!-- TalkCenter -->
{load:__PUBLIC__/js/TalkCenter/class/ui/talkForm.js}
{load:__PUBLIC__/js/TalkCenter/class/ui/talkForm.talkInforList.js}
{load:__PUBLIC__/js/TalkCenter/class/ui/talkCenter.js}
<style type="text/css">
a{cursor: pointer;}
</style>
</head>

<body>
	<div id="wrap">
		{search action="index"}{/search}
	
		<a href="javascript:;" id="newForm">新增窗体</a>
		<a id="newtalkform" href="javascript:;">新建聊天窗口</a>
		<a href="javascript:;" id="msgbox">提示窗口</a>
		
		<div id="ajaxLoad"></div>
		
		<div id="talkForm">
			<a id="btnAddTalkForm">添加聊天窗体</a>
			<script type="text/javascript">
				var talkForms = [];
				;(function($){
					$("#btnAddTalkForm").click(function(){
						var talkForm = new $.classes.ui.talkForm($.salvia.packet("TalkForm.lbi").appendTo("#talkForm"));
						talkForm.datasource({name:"聊天窗口"+talkForms.length},{name:function(name){this.text(name);}});
						talkForm.show();
						$.list.add(talkForms,talkForm);
					});
				})(jQuery)
			</script>
			<div id="talkInforList">
				<a class="btnAdd">添加言论</a>
				<a class="btnAddMe">添加本人言论</a>
				<a class="btnRemove">删除言论</a>
				<div class="infores"></div>
				<script type="text/javascript">
				;(function($){
					//var talkInforList = new $.classes.ui.talkForm.talkInforList($("#talkInforList>.infores"));
					$("#talkInforList .btnAddMe").click(function(){
						var talkForm = talkForms[talkForms.length-1];
						talkForm.addMeTalking({name:"packy",time:(new Date()).ToString(),content:"233"},
						{name:function(name){
							this.dom.find(".name").text(name);
						},
						time:function(time){
							this.dom.find(".time").text(time);
						},
						content:function(content){
							this.dom.find(".message").text(this.id);
						}});
					});
					$("#talkInforList .btnAdd").click(function(){
						var talkForm = talkForms[talkForms.length-1];
						talkForm.addTalking({name:"packy",time:(new Date()).ToString(),content:"233"},
						{name:function(name){
							this.dom.find(".name").text(name);
						},
						time:function(time){
							this.dom.find(".time").text(time);
						},
						content:function(content){
							this.dom.find(".message").text(this.id);
						}});
						
						/*var talkInfor = new $.classes.ui.base($.salvia.packet("TalkInfo.lbi"));
						talkInfor.datasource({name:"packy",time:(new Date()).ToString(),content:"233"},
						{name:function(name){
							this.dom.find(".name").text(name);
						},
						time:function(time){
							this.dom.find(".time").text(time);
						},
						content:function(content){
							this.dom.find(".message").text(this.id);
						}});
						talkInforList.add(talkInfor);*/
					});
					$("#talkInforList .btnRemove").click(function(){
						var talkInforList = (talkForms[talkForms.length-1]).TalkInforList;
						talkInforList.remove(talkInforList.items(0));
					});
				})(jQuery)
				</script>
			</div>
		</div>
		
		<div id="pnlTalkCenter">
			<a id="btnTalkCenter" href="javascript:;">打开聊天中心</a>
			<script>
				(function($){
					$("#btnTalkCenter").click(function(){
						$.TalkCenter = new $.classes.ui.talkCenter($.salvia.packet("TalkCenter.lbi").appendTo("#pnlTalkCenter"));
						$.TalkCenter.show();
						$.TalkCenter.datasource({
								name:"233小姐",
								friends:[
								    {
									    id:0,
									    name:"gb2312",
									    avatar:"1"
									},
									{
									    id:1,
									    name:"B君",
									    avatar:"1"
									},
									{
									    id:2,
									    name:"A君",
									    avatar:"1"
									},
								]
							},
							{
								name:function(name){
									this.text(name);
								},
								friends:function(friends){
									for(var i in friends){
										var friend = this.addContact({},"friend");
										friend.datasource(friends[i],{name:function(name){this.text(name);}});
									}
								}
							}
							);
					});
				})(jQuery);
			</script>
		</div>
		
		
	</div>
	<script>
	;(function($){
		$(document).ready(function(){
			/*
			var d = new Object();
			d.a="a";
			d.b="b";
			d.c=function(){return "c";};

			d.prototype = {
				a:"a1",
				d:function(){return "d";}
			};

			for(var pro in d){
				$(document.body).append("<div>"+pro+":"+typeof(d[pro])=="function"?d[pro]():d[pro]+"</div>");
			}
			
			var printObj = function(obj){
				for(var pro in obj){
					if(pro=="toString"||pro=="valueOf"||pro=="init"){continue;}
					$(document.body).append("<div></div>").find("div:last").append(pro+":"+typeof(obj[pro])=="function"?obj[pro]():obj[pro]);
				}
			};
			var parent = $.salvia.Class({
				init:function(){
					this.name = "233";
				},
				callMyName:function(){
					return "My name is "+this.name;
				}
			});
			var sub = $.salvia.Class(parent,{
				callMyName:function($super){
					return $super()+"....Fuck!!!!";
				}
			});

			var parentObj = new parent();
			var subObj = new sub();
			
			alert(parentObj.callMyName());
			alert(subObj.callMyName());
			*/
			/*var form = new $.classes.ui.form($.salvia.packet("Form.lbi").appendTo($("#wrap")));
			form.datasource({text:"测试用窗体"},{
				text:function(text){
					this.text(text);
				}
			});
			form.show();*/

			var ids = 0;
			var formManager = $.formManager = new $.classes.util.formManager();
			$("#newForm").click(function(){
				var form = new $.classes.ui.form($.salvia.packet("Form.lbi").appendTo($("#wrap")));
				formManager.add(form);
				
				form.datasource({text:"测试用窗体"+ids},{
					text:function(text){
						this.text(text);
					}
				});
				form.show();
				ids++;
			});

			$("#msgbox").click(function(){
				var msg = new $.classes.ui.msgbox($.salvia.packet("Form.lbi"));
				msg.addListener("return",function(result){
					//alert();
				});
				msg.show("提示","内容测试测试",["Yes","No"]);
			});

			var taskbar = new $.classes.ui.taskbar(formManager,"#wrap");

			var list_data = [{name:"1"},{name:"2"},{name:"3"},{name:"4"},{name:"5"}];
			var list = new $.classes.ui.list($(document.createElement("ul")).appendTo($("#wrap")));
			list.datasource(list_data,function(data){
				this.hasCheckBox(true);
				this.text(data.name);
			});
			list.remove(list.items(list.count()-1));
			list.selectAll();

			var mode = new $.classes.mvc.mode({
				url:"/Index/test_data/",
				dataType:"json"
			},{
				data:function(data){
					$.list.remove(data.data.data,data.data.data[0]);
					return data.data;
				}
			});
			var d = {d:1};
			mode.addListener("success",function(e,m,returndata){
				/*for(var i in m.f_data){
					$("#ajaxLoad").append();
				}*/
				$(document).data("data111",returndata);
				e.other.f = m;
			},d);
			mode.load();
			$(document).data("data222",d);
		});
	})(jQuery);
	</script>
</body>
</html>
